<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NKX Exchange</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Source+Serif+4:opsz,wght@8..60,400;600&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=DotGothic16&family=IBM+Plex+Mono:wght@300;400;500;600&display=swap');
        
        body { font-family: 'Inter', sans-serif; margin: 0; padding: 0; }
        
        /* Font Classes for Themes */
        .font-serif-theme {
            font-family: 'Source Serif 4', serif;
        }
        .font-sans-theme {
            font-family: 'Inter', sans-serif; /* Fallback for Geist Sans */
        }
        .font-dot {
            font-family: 'DotGothic16', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .font-mono {
            font-family: 'IBM Plex Mono', monospace;
            letter-spacing: 0.02em;
        }

        .nkx-logo {
            font-family: 'Black Ops One', 'Arial Black', sans-serif;
            font-weight: 400;
            letter-spacing: 0.5px;
        }
        
        .asset-option:hover {
            background-color: #f4f4f5;
        }
        
        .provider-card {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .provider-card:hover {
            border-color: #b1ff8c;
        }
        
        .provider-card.selected {
            border-color: #b1ff8c;
            background-color: #f0fff0;
        }
        
        input:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .spinner {
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef, useMemo } = React;
        
        // ============ ASSET DATA ============
        const ASSETS = [
            { 
                symbol: 'BTC', 
                name: 'Bitcoin', 
                network: 'Bitcoin',
                icon: 'https://cryptologos.cc/logos/bitcoin-btc-logo.png',
                cmcId: 'bitcoin',
                decimals: 8
            },
            { 
                symbol: 'ETH', 
                name: 'Ethereum', 
                network: 'Ethereum',
                icon: 'https://cryptologos.cc/logos/ethereum-eth-logo.png',
                cmcId: 'ethereum',
                decimals: 18
            },
            { 
                symbol: 'USDT', 
                name: 'Tether', 
                network: 'Binance Smart Chain',
                networkTag: 'BSC',
                icon: 'https://cryptologos.cc/logos/tether-usdt-logo.png',
                cmcId: 'tether',
                decimals: 6
            },
            { 
                symbol: 'BNB', 
                name: 'BNB', 
                network: 'BNB Smart Chain',
                networkTag: 'BSC',
                icon: 'https://cryptologos.cc/logos/bnb-bnb-logo.png',
                cmcId: 'binancecoin',
                decimals: 18
            },
            { 
                symbol: 'SOL', 
                name: 'Solana', 
                network: 'Solana',
                icon: 'https://cryptologos.cc/logos/solana-sol-logo.png',
                cmcId: 'solana',
                decimals: 9
            },
            { 
                symbol: 'USDC', 
                name: 'USD Coin', 
                network: 'Ethereum',
                networkTag: 'ETH',
                icon: 'https://cryptologos.cc/logos/usd-coin-usdc-logo.png',
                cmcId: 'usd-coin',
                decimals: 6
            }
        ];

        // ============ PRICE API & CACHE ============
        const priceCache = new Map();
        const CACHE_TTL = 10000; // 10 seconds
        const pendingRequests = new Map();

        async function fetchPrice(fromSymbol, toSymbol) {
            const key = `${fromSymbol}-${toSymbol}`;
            const now = Date.now();
            
            // Check cache
            const cached = priceCache.get(key);
            if (cached && now - cached.timestamp < CACHE_TTL) {
                return cached.rate;
            }
            
            // Check if request is pending
            if (pendingRequests.has(key)) {
                return pendingRequests.get(key);
            }
            
            // Create new request
            const fromAsset = ASSETS.find(a => a.symbol === fromSymbol);
            const toAsset = ASSETS.find(a => a.symbol === toSymbol);
            
            if (!fromAsset || !toAsset) {
                return 1;
            }
            
            const promise = (async () => {
                try {
                    // Using CoinGecko simple price API
                    const response = await fetch(
                        `https://api.coingecko.com/api/v3/simple/price?ids=${fromAsset.cmcId},${toAsset.cmcId}&vs_currencies=usd`
                    );
                    
                    if (!response.ok) {
                        throw new Error('API request failed');
                    }
                    
                    const data = await response.json();
                    const fromPrice = data[fromAsset.cmcId]?.usd || 0;
                    const toPrice = data[toAsset.cmcId]?.usd || 0;
                    
                    if (fromPrice === 0 || toPrice === 0) {
                        throw new Error('Invalid price data');
                    }
                    
                    const rate = fromPrice / toPrice;
                    
                    // Cache the result
                    priceCache.set(key, { rate, timestamp: now });
                    
                    return rate;
                } catch (error) {
                    console.error('Price fetch error:', error);
                    // Fallback: return cached value or mock rate
                    if (cached) return cached.rate;
                    
                    // Mock rates as fallback
                    const mockRates = {
                        'BTC-ETH': 15.5,
                        'ETH-BTC': 0.0645,
                        'BTC-USDT': 43000,
                        'USDT-BTC': 0.0000232,
                        'ETH-USDT': 2300,
                        'USDT-ETH': 0.000434,
                        'BNB-USDT': 310,
                        'SOL-USDT': 98,
                        'USDC-USDT': 1.0001
                    };
                    return mockRates[key] || 1;
                } finally {
                    pendingRequests.delete(key);
                }
            })();
            
            pendingRequests.set(key, promise);
            return promise;
        }

        // ============ HOOKS ============
        function useDebounce(value, delay) {
            const [debouncedValue, setDebouncedValue] = useState(value);
            
            useEffect(() => {
                const handler = setTimeout(() => {
                    setDebouncedValue(value);
                }, delay);
                
                return () => clearTimeout(handler);
            }, [value, delay]);
            
            return debouncedValue;
        }

        // ============ MODAL COMPONENT ============
        function AssetPickerModal({ isOpen, onClose, onSelect, excludeSymbol }) {
            const [search, setSearch] = useState('');
            
            if (!isOpen) return null;
            
            const filtered = ASSETS.filter(asset => 
                asset.symbol !== excludeSymbol &&
                (asset.symbol.toLowerCase().includes(search.toLowerCase()) ||
                 asset.name.toLowerCase().includes(search.toLowerCase()))
            );
            
            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" onClick={onClose}>
                    <div className="bg-white rounded-[16px] p-[24px] w-[400px] max-h-[600px] overflow-auto" onClick={e => e.stopPropagation()}>
                        <div className="flex items-center justify-between mb-4">
                            <h3 className="text-[20px] font-semibold">Select Token</h3>
                            <button onClick={onClose} className="text-[24px] text-[#767676] hover:text-[#0a0a0a]">&times;</button>
                        </div>
                        
                        <input
                            type="text"
                            placeholder="Search by name or symbol"
                            value={search}
                            onChange={(e) => setSearch(e.target.value)}
                            className="w-full px-4 py-2 border border-[#d0d0d0] rounded-[8px] mb-4 outline-none focus:border-[#b1ff8c] focus:ring-2 focus:ring-[#b1ff8c]/20"
                        />
                        
                        <div className="space-y-1">
                            {filtered.map(asset => (
                                <div
                                    key={asset.symbol}
                                    className="asset-option flex items-center gap-3 p-3 rounded-[8px] cursor-pointer"
                                    onClick={() => {
                                        onSelect(asset);
                                        onClose();
                                    }}
                                >
                                    <img src={asset.icon} alt={asset.symbol} className="w-[36px] h-[36px] rounded-full" />
                                    <div className="flex-1">
                                        <div className="font-semibold text-[16px]">{asset.symbol}</div>
                                        <div className="text-[12px] text-[#767676]">{asset.name}</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        // ============ THEMES ============
        const THEMES = {
            buidlpad: {
                id: 'buidlpad',
                name: 'BuidlPad',
                light: {
                    bgPage: '#FAF9F5', // Cream
                    bgCard: '#ffffff',
                    textPrimary: '#141413',
                    textSecondary: '#3A3A38',
                    primaryAction: '#c96542', // Terra Cotta
                    primaryText: '#ffffff',
                    radiusCard: '12px',
                    radiusBtn: '8px',
                    stepActive: '#c96542',
                    stepInactive: '#E6E4DD',
                    stepTextActive: '#ffffff',
                    stepTextInactive: '#141413',
                    fontFamily: "'Source Serif 4', serif",
                    borderColor: '#e5e5e5',
                    inputBg: '#ffffff',
                    inputGap: '12px',
                    inputPadding: '18px',
                    cardPadding: '24px',
                    arrowBorder: '4px',
                    cardWidth: '100%'
                },
                dark: {
                    bgPage: '#1c1c1a', // Dark warm gray
                    bgCard: '#262624',
                    textPrimary: '#ededec',
                    textSecondary: '#a1a1aa',
                    primaryAction: '#e07a5f', // Brighter Terra Cotta
                    primaryText: '#1c1c1a',
                    radiusCard: '12px',
                    radiusBtn: '8px',
                    stepActive: '#e07a5f',
                    stepInactive: '#3f3f3e',
                    stepTextActive: '#1c1c1a',
                    stepTextInactive: '#a1a1aa',
                    fontFamily: "'Source Serif 4', serif",
                    borderColor: '#3f3f3e',
                    inputBg: '#1c1c1a',
                    inputGap: '12px',
                    inputPadding: '18px',
                    cardPadding: '24px',
                    cardWidth: '100%'
                }
            },
            wise: {
                id: 'wise',
                name: 'Wise',
                light: {
                    bgPage: 'rgba(24,202,81,0.08)',
                    bgCard: '#ffffff',
                    textPrimary: '#37517e',
                    textSecondary: '#5d7079',
                    primaryAction: '#9fe870',
                    primaryText: '#163300',
                    radiusCard: '24px',
                    radiusBtn: '9999px',
                    stepActive: '#9fe870',
                    stepInactive: '#EAF0F6',
                    stepTextActive: '#163300',
                    stepTextInactive: '#37517e',
                    fontFamily: "'Inter', sans-serif",
                    borderColor: 'transparent',
                    inputBg: '#f7f9fd',
                    inputGap: '12px',
                    inputPadding: '18px',
                    cardPadding: '24px',
                    arrowBorder: '4px',
                    cardWidth: '100%'
                },
                dark: {
                    bgPage: '#141E30', // Deep Navy
                    bgCard: '#1d2b45',
                    textPrimary: '#ffffff',
                    textSecondary: '#94a3b8',
                    primaryAction: '#b1ff8c', // Bright Green
                    primaryText: '#0f172a',
                    radiusCard: '24px',
                    radiusBtn: '9999px',
                    stepActive: '#b1ff8c',
                    stepInactive: '#2d3f5e',
                    stepTextActive: '#0f172a',
                    stepTextInactive: '#94a3b8',
                    fontFamily: "'Inter', sans-serif",
                    borderColor: 'transparent',
                    inputBg: '#0f172a',
                    inputGap: '12px',
                    inputPadding: '18px',
                    cardPadding: '24px',
                    cardWidth: '100%'
                }
            },
            coinex: {
                id: 'coinex',
                name: 'CoinEx',
                light: {
                    bgPage: '#F9FAFB', // Light Gray
                    bgCard: '#FFFFFF',
                    textPrimary: '#1F2937', // Gray 800
                    textSecondary: '#6B7280', // Gray 500
                    primaryAction: '#0EAD98', // Bamboo Green
                    primaryText: '#FFFFFF',
                    radiusCard: '8px',
                    radiusBtn: '4px',
                    stepActive: '#0EAD98',
                    stepInactive: '#E5E7EB',
                    stepTextActive: '#FFFFFF',
                    stepTextInactive: '#1F2937',
                    fontFamily: "'Manrope', sans-serif",
                    borderColor: '#E5E7EB',
                    inputBg: '#F3F4F6',
                    inputGap: '12px',
                    inputPadding: '18px',
                    cardPadding: '24px',
                    arrowBorder: '4px',
                    cardWidth: '100%'
                },
                dark: {
                    bgPage: '#111827', // Gray 900
                    bgCard: '#1F2937', // Gray 800
                    textPrimary: '#F9FAFB', // Gray 50
                    textSecondary: '#9CA3AF', // Gray 400
                    primaryAction: '#10B981', // Emerald 500
                    primaryText: '#FFFFFF',
                    radiusCard: '8px',
                    radiusBtn: '4px',
                    stepActive: '#10B981',
                    stepInactive: '#374151',
                    stepTextActive: '#FFFFFF',
                    stepTextInactive: '#9CA3AF',
                    fontFamily: "'Manrope', sans-serif",
                    borderColor: '#374151',
                    inputBg: '#111827',
                    inputGap: '12px',
                    inputPadding: '18px',
                    cardPadding: '24px',
                    cardWidth: '100%'
                }
            },
            uniswap: {
                id: 'uniswap',
                name: 'Uniswap',
                light: {
                    bgPage: 'rgba(24,202,81,0.08)',
                    bgCard: '#FFFFFF',
                    textPrimary: '#37517e', // Wise Navy
                    textSecondary: '#5d6b82', // Muted Navy
                    primaryAction: '#9fe870', // Wise Forest Green
                    primaryText: '#163300', // Dark Forest
                    radiusCard: '24px',
                    radiusBtn: '9999px',
                    stepActive: '#9fe870',
                    stepInactive: '#EAF0F6',
                    stepTextActive: '#163300',
                    stepTextInactive: '#37517e',
                    fontFamily: "'Inter', sans-serif",
                    borderColor: 'transparent',
                    inputBg: '#F9FAFB',
                    inputGap: '4px',
                    inputPadding: '16px',
                    cardPadding: '12px',
                    cardWidth: '480px'
                },
                dark: {
                    bgPage: '#131a2a', // Dark Navy
                    bgCard: '#1b263b',
                    textPrimary: '#FFFFFF',
                    textSecondary: '#94a3b8',
                    primaryAction: '#9fe870',
                    primaryText: '#163300',
                    radiusCard: '24px',
                    radiusBtn: '9999px',
                    stepActive: '#9fe870',
                    stepInactive: '#2d3f5e',
                    stepTextActive: '#163300',
                    stepTextInactive: '#94a3b8',
                    fontFamily: "'Inter', sans-serif",
                    borderColor: 'transparent',
                    inputBg: '#0d131f',
                    inputGap: '4px',
                    inputPadding: '16px',
                    cardPadding: '12px',
                    cardWidth: '480px'
                }
            },
            nothing: {
                id: 'nothing',
                name: 'Nothing',
                light: {
                    bgPage: '#FFFFFF',
                    bgCard: '#FFFFFF',
                    textPrimary: '#000000',
                    textSecondary: '#333333',
                    primaryAction: '#000000',
                    primaryText: '#FFFFFF',
                    radiusCard: '0px',
                    radiusBtn: '0px',
                    stepActive: '#000000',
                    stepInactive: '#E5E5E5',
                    stepTextActive: '#FFFFFF',
                    stepTextInactive: '#000000',
                    fontFamily: "'IBM Plex Mono', monospace",
                    fontFamilyHeading: "'DotGothic16', sans-serif",
                    borderColor: '#000000',
                    inputBg: '#FFFFFF',
                    inputGap: '8px',
                    inputPadding: '16px',
                    cardPadding: '24px',
                    cardWidth: '100%'
                },
                dark: {
                    bgPage: '#000000',
                    bgCard: '#1A1A1A',
                    textPrimary: '#FFFFFF',
                    textSecondary: '#CCCCCC',
                    primaryAction: '#FFFFFF',
                    primaryText: '#000000',
                    radiusCard: '0px',
                    radiusBtn: '0px',
                    stepActive: '#FFFFFF',
                    stepInactive: '#333333',
                    stepTextActive: '#000000',
                    stepTextInactive: '#FFFFFF',
                    fontFamily: "'IBM Plex Mono', monospace",
                    fontFamilyHeading: "'DotGothic16', sans-serif",
                    borderColor: '#FFFFFF',
                    inputBg: '#000000',
                    inputGap: '8px',
                    inputPadding: '16px',
                    cardPadding: '24px',
                    cardWidth: '100%'
                }
            }
        };

        // ============ STEP CONTROLLER COMPONENT ============
        function StepController({ currentStep, onStepClick, onPrev, onNext, theme, setTheme, themeMode, setThemeMode, viewMode, setViewMode }) {
            const steps = [
                { id: 1, label: 'Step 1: Select Pair' },
                { id: 2, label: 'Step 2: Enter Address' },
                { id: 3, label: 'Step 3: Send Funds' },
                { id: 4, label: 'Step 4: Wait Exchange' }
            ];
            
            return (
                <div className="bg-white border border-[#e4e4e7] content-stretch flex flex-col gap-[8px] items-start p-[8px] relative rounded-[8px] shadow-[0px_10px_15px_-3px_rgba(0,0,0,0.1)] shrink-0 w-[208.266px]">
                    <div className="border-[#e4e4e7] border-[0px_0px_1px] border-solid content-stretch flex flex-col items-start pb-[6px] pt-0 px-0 relative shrink-0 w-full">
                        <div className="h-[20px] relative shrink-0 w-full flex justify-between items-center">
                            <p className="font-semibold leading-[20px] not-italic text-[#09090b] text-[14px] text-nowrap">
                                Step Controller
                            </p>
                            <button
                                onClick={() => setViewMode(viewMode === 'web' ? 'mobile' : 'web')}
                                className="w-[20px] h-[20px] flex items-center justify-center rounded hover:bg-gray-100 transition-colors"
                                title={viewMode === 'web' ? 'Switch to Mobile View' : 'Switch to Web View'}
                            >
                                {viewMode === 'web' ? (
                                    <svg className="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                    </svg>
                                ) : (
                                    <svg className="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
                                    </svg>
                                )}
                            </button>
                        </div>
                    </div>

                    {/* Theme Selector */}
                    <div className="w-full mb-1">
                        <label className="text-[10px] text-gray-500 font-medium mb-1 block">Theme</label>
                         <div className="flex flex-wrap gap-1 bg-gray-100 p-1 rounded-lg">
                            {Object.values(THEMES).map(t => (
                                <button
                                    key={t.id}
                                    onClick={() => setTheme(t.id)}
                                    className={`flex-1 py-1 px-2 text-[10px] font-medium rounded transition-all ${
                                        theme === t.id 
                                        ? 'bg-white shadow-sm text-black' 
                                        : 'text-gray-500 hover:text-gray-700'
                                    }`}
                                >
                                    {t.name}
                                </button>
                            ))}
                         </div>
                    </div>

                    {/* Mode Selector */}
                    <div className="w-full mb-2">
                        <label className="text-[10px] text-gray-500 font-medium mb-1 block">Mode</label>
                        <div className="flex bg-gray-100 p-1 rounded-lg">
                            <button
                                onClick={() => setThemeMode('light')}
                                className={`flex-1 py-1 text-[10px] font-medium rounded transition-all ${
                                    themeMode === 'light'
                                    ? 'bg-white shadow-sm text-black'
                                    : 'text-gray-500 hover:text-gray-700'
                                }`}
                            >
                                Light
                            </button>
                            <button
                                onClick={() => setThemeMode('dark')}
                                className={`flex-1 py-1 text-[10px] font-medium rounded transition-all ${
                                    themeMode === 'dark'
                                    ? 'bg-white shadow-sm text-black'
                                    : 'text-gray-500 hover:text-gray-700'
                                }`}
                            >
                                Dark
                            </button>
                        </div>
                    </div>

                    <div className="content-stretch flex flex-col gap-[4px] h-[168px] items-start relative shrink-0 w-full">
                        {steps.map((step) => (
                            <div 
                                key={step.id}
                                className={`relative rounded-[6px] shrink-0 w-full ${
                                    step.id === currentStep 
                                        ? 'bg-[#18181b]' 
                                        : 'bg-[#f4f4f5]'
                                }`}
                                onClick={() => onStepClick && onStepClick(step.id)}
                                style={{ cursor: 'pointer' }}
                            >
                                <div className="bg-clip-padding border-0 border-[transparent] border-solid content-stretch flex items-center p-[8px] relative w-full">
                                    <p className={`font-medium leading-[20px] not-italic relative shrink-0 text-[14px] text-center text-nowrap ${
                                        step.id === currentStep 
                                            ? 'text-[#fafafa]' 
                                            : 'text-[#18181b]'
                                    }`}>
                                        {step.label}
                                    </p>
                                </div>
                            </div>
                        ))}
                    </div>
                    <div className="content-stretch flex gap-[8px] items-start relative shrink-0 w-full">
                        <div 
                            className={`basis-0 bg-[#f4f4f5] grow h-[32px] min-h-px min-w-px relative rounded-[6px] shrink-0 ${
                                currentStep === 1 ? 'opacity-50' : ''
                            }`}
                            onClick={() => currentStep > 1 && onPrev && onPrev()}
                            style={{ cursor: currentStep > 1 ? 'pointer' : 'not-allowed' }}
                        >
                            <div className="bg-clip-padding border-0 border-[transparent] border-solid content-stretch flex items-start px-[12px] py-[8px] relative size-full">
                                <p className="basis-0 font-medium grow leading-[16px] min-h-px min-w-px not-italic relative shrink-0 text-[#18181b] text-[12px] text-center">
                                    ← Prev
                                </p>
                            </div>
                        </div>
                        <div 
                            className="basis-0 bg-[#f4f4f5] grow h-[32px] min-h-px min-w-px relative rounded-[6px] shrink-0"
                            onClick={() => currentStep < 4 && onNext && onNext()}
                            style={{ cursor: currentStep < 4 ? 'pointer' : 'not-allowed', opacity: currentStep === 4 ? 0.5 : 1 }}
                        >
                            <div className="bg-clip-padding border-0 border-[transparent] border-solid content-stretch flex items-start px-[12px] py-[8px] relative size-full">
                                <p className="basis-0 font-medium grow leading-[16px] min-h-px min-w-px not-italic relative shrink-0 text-[#18181b] text-[12px] text-center">
                                    Next →
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // ============ DEVICE SIMULATOR COMPONENT ============
        function DeviceSimulator({ children }) {
            return (
                <div className="min-h-screen bg-gray-100 flex items-center justify-center p-8 transition-all duration-300 fixed inset-0 z-40 overflow-y-auto">
                    <div className="relative bg-black rounded-[50px] p-3 shadow-2xl shrink-0">
                        {/* Notch */}
                        <div className="absolute top-0 left-1/2 transform -translate-x-1/2 w-[170px] h-[30px] bg-black rounded-b-[20px] z-50"></div>
                        
                        {/* Screen Container */}
                        <div 
                            className="relative bg-white rounded-[42px] overflow-hidden"
                            style={{ 
                                width: '390px', 
                                height: '844px',
                            }}
                        >
                            {/* Scrollable Content */}
                            <div className="w-full h-full overflow-y-auto overflow-x-hidden hide-scrollbar">
                                {children}
                            </div>
                        </div>

                        {/* Home Indicator */}
                        <div className="absolute bottom-2 left-1/2 transform -translate-x-1/2 w-[134px] h-[5px] bg-white rounded-full z-50"></div>
                    </div>
                </div>
            );
        }

        // ============ MAIN EXCHANGE COMPONENT ============
        function ExchangeApp() {
            // State management
            const [theme, setTheme] = useState('buidlpad');
            const [themeMode, setThemeMode] = useState('light');
            const [viewMode, setViewMode] = useState('web'); // 'web' or 'mobile'
            const currentTheme = THEMES[theme][themeMode];

            const [step, setStep] = useState(1);
            const [mode, setMode] = useState('realtime'); // 'realtime' or 'fixed'
            const [fromAsset, setFromAsset] = useState(ASSETS[2]); // USDT
            const [toAsset, setToAsset] = useState(ASSETS[1]); // ETH
            const [fromAmount, setFromAmount] = useState('50000');
            const [toAmount, setToAmount] = useState('');
            const [rate, setRate] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');
            const [fixedRateExpiry, setFixedRateExpiry] = useState(null);
            const [walletAddress, setWalletAddress] = useState('');
            const [selectedProvider, setSelectedProvider] = useState('NKX');
            const [showFromPicker, setShowFromPicker] = useState(false);
            const [showToPicker, setShowToPicker] = useState(false);
            const [processing, setProcessing] = useState(false);
            
            const debouncedFromAmount = useDebounce(fromAmount, 500);
            
            // Quote calculation with spread and fees
            const calculateQuote = useCallback((baseRate, provider, amount) => {
                if (!baseRate || !amount) return 0;
                
                const providers = {
                    'NKX': { spreadBps: 20, networkFee: 0.0001, serviceFee: 0.0025 },
                    'Changelly': { spreadBps: 60, networkFee: 0.0001, serviceFee: 0.005 },
                    'ChangeNOW': { spreadBps: 40, networkFee: 0.00015, serviceFee: 0.003 }
                };
                
                const config = providers[provider];
                const spread = 1 - (config.spreadBps / 10000);
                const result = (parseFloat(amount) * baseRate * spread) - config.networkFee;
                
                return Math.max(0, result);
            }, []);
            
            // Fetch price and update amounts
            const updatePrice = useCallback(async () => {
                if (!fromAsset || !toAsset) return;
                
                setLoading(true);
                setError('');
                
                try {
                    const newRate = await fetchPrice(fromAsset.symbol, toAsset.symbol);
                    setRate(newRate);
                    
                    if (debouncedFromAmount) {
                        const calculated = calculateQuote(newRate, selectedProvider, debouncedFromAmount);
                        setToAmount(calculated.toFixed(8));
                    }
                } catch (err) {
                    setError('Failed to fetch price');
                    console.error(err);
                } finally {
                    setLoading(false);
                }
            }, [fromAsset, toAsset, debouncedFromAmount, selectedProvider, calculateQuote]);
            
            // Update price on mount and when dependencies change
            useEffect(() => {
                updatePrice();
            }, [updatePrice]);
            
            // Real-time rate refresh
            useEffect(() => {
                if (mode === 'realtime') {
                    const interval = setInterval(() => {
                        updatePrice();
                    }, 10000); // Refresh every 10 seconds
                    
                    return () => clearInterval(interval);
                }
            }, [mode, updatePrice]);
            
            // Fixed rate expiry countdown
            useEffect(() => {
                if (mode === 'fixed' && fixedRateExpiry) {
                    const interval = setInterval(() => {
                        if (Date.now() > fixedRateExpiry) {
                            setFixedRateExpiry(null);
                            setMode('realtime');
                        }
                    }, 1000);
                    
                    return () => clearInterval(interval);
                }
            }, [mode, fixedRateExpiry]);
            
            // Mode switch handler
            const handleModeSwitch = (newMode) => {
                setMode(newMode);
                if (newMode === 'fixed') {
                    setFixedRateExpiry(Date.now() + 60000); // 60 seconds
                    updatePrice();
                } else {
                    setFixedRateExpiry(null);
                }
            };
            
            // Swap assets
            const handleSwap = () => {
                setFromAsset(toAsset);
                setToAsset(fromAsset);
                setFromAmount(toAmount);
                setToAmount(fromAmount);
            };
            
            // Amount input handlers
            const handleFromAmountChange = (value) => {
                setFromAmount(value);
            };
            
            const handleToAmountChange = (value) => {
                setToAmount(value);
                // Reverse calculate from amount
                if (rate && value) {
                    const reverseAmount = parseFloat(value) / rate;
                    setFromAmount(reverseAmount.toFixed(8));
                }
            };
            
            // Providers quotes
            const providers = useMemo(() => {
                if (!rate || !fromAmount) return [];
                
                return ['NKX', 'ChangeNOW', 'Changelly'].map(name => {
                    const amount = calculateQuote(rate, name, fromAmount);
                    return { name, amount };
                }).sort((a, b) => b.amount - a.amount);
            }, [rate, fromAmount, calculateQuote]);
            
            // Best provider (highest amount)
            const bestProvider = providers[0]?.name;
            
            // Validation
            const isValidAmount = fromAmount && parseFloat(fromAmount) > 0;
            const isValidAddress = walletAddress.length >= 20;
            const canProceed = step === 1 ? isValidAmount : 
                              step === 2 ? isValidAddress : 
                              step === 3 ? true : false;
            
            // Step navigation
            const handleNextStep = () => {
                if (step < 4 && canProceed) {
                    if (step === 3) {
                        setProcessing(true);
                        setTimeout(() => {
                            setStep(4);
                            setProcessing(false);
                        }, 2000);
                    } else {
                        setStep(step + 1);
                    }
                }
            };
            
            const handlePrevStep = () => {
                if (step > 1) setStep(step - 1);
            };
            
            // Fixed rate countdown display
            const fixedRateCountdown = fixedRateExpiry 
                ? Math.max(0, Math.ceil((fixedRateExpiry - Date.now()) / 1000))
                : 0;
            
            return (
                <div 
                    className="relative min-h-screen transition-colors duration-300 overflow-clip" 
                    style={{ 
                        backgroundColor: (theme === 'wise' && themeMode === 'light') || (theme === 'uniswap' && themeMode === 'light') ? undefined : currentTheme.bgPage,
                        backgroundImage: (theme === 'wise' && themeMode === 'light') || (theme === 'uniswap' && themeMode === 'light')
                            ? 'linear-gradient(90deg, rgba(24, 202, 81, 0.08) 0%, rgba(24, 202, 81, 0.08) 100%), linear-gradient(90deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%)'
                            : undefined,
                        color: currentTheme.textPrimary 
                    }}
                >
                    {/* Wise & Uniswap Theme Background Decorations */}
                    {((theme === 'wise' && themeMode === 'light') || (theme === 'uniswap' && themeMode === 'light')) && (
                        <>
                            {/* SVG Group */}
                            <div style={{ position: 'absolute', inset: '-13.7% 76.71% 57.5% -12.4%', pointerEvents: 'none', zIndex: 0 }}>
                                <div style={{ position: 'absolute', inset: '-11.79% -10.44%' }}>
                                    <img 
                                        src="http://localhost:3845/assets/cfaa8ae6d4f571ea92f28ece04faef1b1c2d3c46.svg" 
                                        alt="" 
                                        style={{ display: 'block', maxWidth: 'none', width: '100%', height: '100%' }}
                                    />
                                </div>
                            </div>
                            
                            {/* Cyan Gradient Blur */}
                            <div 
                                style={{
                                    position: 'absolute',
                                    filter: 'blur(67.5px)',
                                    height: '324px',
                                    right: '-71px',
                                    borderRadius: '216px',
                                    top: '-25px',
                                    width: '540px',
                                    pointerEvents: 'none',
                                    zIndex: 0,
                                    backgroundImage: "url('data:image/svg+xml;utf8,<svg viewBox=\\'0 0 540 324\\' xmlns=\\'http://www.w3.org/2000/svg\\' preserveAspectRatio=\\'none\\'><rect x=\\'0\\' y=\\'0\\' height=\\'100%\\' width=\\\'100%\\' fill=\\\'url(%23grad)\\\' opacity=\\\'1\\\'/><defs><radialGradient id=\\\'grad\\\' gradientUnits=\\\'userSpaceOnUse\\\' cx=\\\'0\\\' cy=\\\'0\\\' r=\\\'10\\\' gradientTransform=\\\'matrix(31.487 0 0 31.487 270 162)\\\'><stop stop-color=\\\'rgba(0,219,206,1)\\\' offset=\\\'0\\\'/><stop stop-color=\\\'rgba(0,219,206,0)\\\' offset=\\\'0.8\\\'/></radialGradient></defs></svg>')"
                                }}
                            />
                            
                            {/* Green Gradient Blur */}
                            <div 
                                style={{
                                    position: 'absolute',
                                    filter: 'blur(54px)',
                                    height: '486px',
                                    right: '280px',
                                    borderRadius: '256.5px',
                                    top: '137px',
                                    width: '540px',
                                    pointerEvents: 'none',
                                    zIndex: 0,
                                    backgroundImage: "url('data:image/svg+xml;utf8,<svg viewBox=\\\'0 0 540 486\\\' xmlns=\\\'http://www.w3.org/2000/svg\\\' preserveAspectRatio=\\\'none\\\'><rect x=\\\'0\\\' y=\\\'0\\\' height=\\\'100%\\\' width=\\\'100%\\\' fill=\\\'url(%23grad)\\\' opacity=\\\'1\\\'/><defs><radialGradient id=\\\'grad\\\' gradientUnits=\\\'userSpaceOnUse\\\' cx=\\\'0\\\' cy=\\\'0\\\' r=\\\'10\\\' gradientTransform=\\\'matrix(36.325 0 0 36.325 270 243)\\\'><stop stop-color=\\\'rgba(105,255,68,1)\\\' offset=\\\'0\\\'/><stop stop-color=\\\'rgba(105,255,68,0)\\\' offset=\\\'0.5\\\'/></radialGradient></defs></svg>')"
                                }}
                            />
                        </>
                    )}
                    
                    {/* Navbar */}
                    <div className="bg-transparent w-full relative" style={{ zIndex: 1 }}>
                        <div className="max-w-[1280px] mx-auto px-[16px] h-[68px] flex items-center justify-between relative">
                            {/* Logo */}
                            <div className="flex items-center gap-[24px]">
                                <div className="nkx-logo h-[46px] w-[81px] relative flex items-center justify-center">
                                    <svg width="81" height="46" viewBox="0 0 81 46" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12.9404 13.145C14.1084 13.145 15.2539 13.2798 16.377 13.5493C17.5225 13.8188 18.6118 14.2231 19.645 14.7622C20.6782 15.2788 21.5879 15.9751 22.374 16.8511C23.1826 17.7271 23.6206 18.7715 23.688 19.9844V21.3994V32.147C23.5532 33.4946 22.812 34.2246 21.4644 34.3369C20.8354 34.3369 20.2852 34.1348 19.8135 33.7305C19.3643 33.3037 19.1396 32.7759 19.1396 32.147V21.0288C19.0947 20.3325 18.8252 19.7598 18.3311 19.3105C17.8594 18.8389 17.3203 18.4683 16.7139 18.1987C16.1299 17.9292 15.5122 17.7271 14.8608 17.5923C14.2319 17.4575 13.5918 17.3901 12.9404 17.3901C12.2891 17.3901 11.6377 17.4575 10.9863 17.5923C10.3574 17.7271 9.73975 17.9292 9.1333 18.1987C8.54932 18.4683 8.01025 18.8389 7.51611 19.3105C7.04443 19.7598 6.78613 20.3325 6.74121 21.0288V32.147C6.62891 33.4946 5.89893 34.2246 4.55127 34.3369C3.92236 34.3369 3.37207 34.1348 2.90039 33.7305C2.45117 33.3037 2.22656 32.7759 2.22656 32.147V21.3994V19.9844C2.29395 18.7715 2.7207 17.7271 3.50684 16.8511C4.29297 15.9751 5.20264 15.2788 6.23584 14.7622C7.26904 14.2231 8.34717 13.8188 9.47021 13.5493C10.6157 13.2798 11.7725 13.145 12.9404 13.145ZM30.2578 13.5156C30.8643 13.5381 31.3809 13.7627 31.8076 14.1895C32.2344 14.5938 32.459 15.0991 32.4814 15.7056V32.2144C32.3467 33.562 31.6055 34.292 30.2578 34.4043C29.6289 34.4043 29.0786 34.2021 28.6069 33.7979C28.1577 33.3711 27.9331 32.8433 27.9331 32.2144V15.7056C27.9556 15.0767 28.1914 14.5601 28.6406 14.1558C29.0898 13.729 29.6289 13.5156 30.2578 13.5156ZM36.019 19.4453C37.5239 18.4346 39.5566 17.4126 42.1172 16.3794L47.6426 14.021C47.8896 13.9087 48.1592 13.8413 48.4512 13.8188C49.0801 13.7739 49.6191 13.9648 50.0684 14.3916C50.5176 14.7959 50.7422 15.3237 50.7422 15.9751C50.7422 16.7163 50.585 17.2666 50.2705 17.626C49.9785 17.9629 49.5967 18.2437 49.125 18.4683L44.4082 20.2539C43.4873 20.6133 42.6113 20.9727 41.7803 21.332C40.9717 21.6689 40.2305 22.062 39.5566 22.5112C38.8828 22.9155 38.5234 23.376 38.4785 23.8926C38.5234 24.3867 38.8828 24.8472 39.5566 25.2739C40.2305 25.7231 40.9717 26.1274 41.7803 26.4868C42.6113 26.8237 43.4873 27.1719 44.4082 27.5312L49.6641 29.4517C50.1357 29.6763 50.5176 29.9683 50.8096 30.3276C51.124 30.6646 51.2812 31.2036 51.2812 31.9448C51.2812 32.5962 51.0566 33.1353 50.6074 33.562C50.1582 33.9663 49.6191 34.146 48.9902 34.1011C48.6982 34.0786 48.4287 34.0112 48.1816 33.8989L42.1172 31.4058C39.5566 30.3726 37.5127 29.3506 35.9854 28.3398C34.4805 27.3066 33.7168 25.8242 33.6943 23.8926C33.7168 21.9609 34.4917 20.4785 36.019 19.4453ZM64.0166 23.522C63.4102 22.3765 62.6465 21.2871 61.7256 20.2539C60.8047 19.2207 59.9175 18.6592 59.064 18.5693H56.2339C55.605 18.5693 55.0771 18.3447 54.6504 17.8955C54.2012 17.4688 53.9766 16.9409 53.9766 16.312C53.9766 15.6831 54.1899 15.1553 54.6167 14.7285C55.0659 14.2793 55.605 14.0547 56.2339 14.0547H59.064V14.0884H59.4009C61.0181 14.1782 62.6914 15.0879 64.4209 16.8174C65.2744 17.6934 66.0605 18.6816 66.7793 19.7822C67.498 18.6816 68.2954 17.6934 69.1714 16.8174C70.8784 15.0879 72.5405 14.1782 74.1577 14.0884H74.4946V14.0547H77.3247C77.9536 14.0547 78.4814 14.2793 78.9082 14.7285C79.3574 15.1553 79.582 15.6831 79.582 16.312C79.582 16.9409 79.3574 17.4688 78.9082 17.8955C78.4814 18.3447 77.9536 18.5693 77.3247 18.5693H74.4946C73.6411 18.6592 72.7539 19.2207 71.833 20.2539C70.9121 21.2871 70.1484 22.3765 69.542 23.522C69.4072 23.769 69.2725 24.0049 69.1377 24.2295C69.1826 24.2969 69.2275 24.3643 69.2725 24.4316C69.8789 25.5996 70.6426 26.7002 71.5635 27.7334C72.4844 28.7666 73.3716 29.3169 74.2251 29.3843H77.0552C77.6841 29.3843 78.2119 29.6089 78.6387 30.0581C79.0879 30.4849 79.3125 31.0127 79.3125 31.6416C79.3125 32.2705 79.0879 32.8096 78.6387 33.2588C78.2119 33.6855 77.6841 33.8989 77.0552 33.8989H73.8882C72.271 33.8091 70.6089 32.9106 68.9019 31.2036C68.1382 30.4175 67.4307 29.564 66.7793 28.6431C66.1279 29.564 65.4204 30.4175 64.6567 31.2036C62.9497 32.9106 61.2876 33.8091 59.6704 33.8989H56.5034C55.8745 33.8989 55.3354 33.6855 54.8862 33.2588C54.4595 32.8096 54.2461 32.2705 54.2461 31.6416C54.2461 31.0127 54.4707 30.4849 54.9199 30.0581C55.3467 29.6089 55.8745 29.3843 56.5034 29.3843H59.3335C60.187 29.3169 61.0742 28.7666 61.9951 27.7334C62.916 26.7002 63.6797 25.5996 64.2861 24.4316C64.3311 24.3643 64.376 24.2969 64.4209 24.2295C64.2861 24.0049 64.1514 23.769 64.0166 23.522Z" fill="#1F1F1F"/>
                                    </svg>
                                </div>
                            </div>
                            
                            {/* Center Nav */}
                            <div className="absolute left-[calc(50%+0.5px)] top-[14px] translate-x-[-50%] flex gap-[8px] items-center">
                                <button className={`px-4 py-2 h-[40px] text-[14px] font-medium leading-[20px] text-center whitespace-nowrap ${theme === 'nothing' ? 'font-mono uppercase border border-black' : ''}`} style={{ color: theme === 'nothing' ? currentTheme.textPrimary : '#1f1f1f', fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined, borderRadius: theme === 'nothing' ? '0px' : undefined }}>
                                    {theme === 'nothing' ? 'FLASH SWAP' : 'Flash Swap'}
                                </button>
                                <button className={`px-4 py-2 h-[40px] text-[14px] font-medium leading-[20px] text-center whitespace-nowrap opacity-50 ${theme === 'nothing' ? 'font-mono uppercase border border-black' : ''}`} style={{ color: theme === 'nothing' ? currentTheme.textPrimary : '#1f1f1f', fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined, borderRadius: theme === 'nothing' ? '0px' : undefined }}>
                                    {theme === 'nothing' ? 'HISTORY' : 'History'}
                                </button>
                            </div>
                            
                            {/* Right side buttons (hidden per design) */}
                            <div className="flex gap-[8px] items-center justify-end opacity-0">
                                <button className="p-2 rounded-full w-[40px] h-[40px] flex items-center justify-center">
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                                    </svg>
                                </button>
                                <button className="px-4 py-2 h-[40px] bg-[#1f1f1f] text-[14px] font-medium text-white rounded-full">
                                    Login
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    {/* Main Content */}
                    <div className="max-w-[794px] mx-auto pt-[55px] px-4 relative" style={{ zIndex: 1 }}>
                        {/* Header */}
                        <div className="text-center mb-[36px]">
                            <h1 
                                className={`text-[46px] font-normal leading-[52px] mb-[30px] transition-colors duration-300 ${theme === 'nothing' ? 'font-dot uppercase' : ''}`}
                                style={{ 
                                    color: currentTheme.textPrimary,
                                    fontFamily: currentTheme.fontFamilyHeading || currentTheme.fontFamily // Apply theme font to H1
                                }}
                            >
                                {theme === 'nothing' ? 'EXCHANGE ANY CRYPTO SECURELY' : 'Exchange any crypto securely'}
                            </h1>
                            <p className={`text-[16px] leading-[24px] transition-colors duration-300 ${theme === 'nothing' ? 'font-mono' : ''}`} style={{ color: currentTheme.textSecondary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                Exchange Bitcoin and 1000+ altcoins in a fast, simple, and secure way.
                            </p>
                        </div>
                        
                        {/* Exchange Card */}
                        <div 
                            className={`mb-[24px] border transition-all duration-300 mx-auto relative ${theme === 'nothing' ? '' : 'shadow-sm'}`}
                            style={{ 
                                padding: currentTheme.cardPadding,
                                backgroundColor: currentTheme.bgCard,
                                borderRadius: currentTheme.radiusCard, 
                                borderColor: currentTheme.borderColor,
                                width: currentTheme.cardWidth,
                                maxWidth: '100%',
                                zIndex: 1
                            }}
                        >
                            {/* Step Header */}
                            <div className="mb-[10px]">
                                {/* Progress Bar */}
                                <div className="flex items-center justify-between mb-[4px]">
                                    {[1,2,3,4].map((i, index) => (
                                        <div key={i} className={`flex items-center ${index < 3 ? 'flex-1' : ''} min-w-0`}>
                                            <div 
                                                className={`flex items-center justify-center w-[32px] h-[32px] shrink-0 pb-[4.5px] pt-[3.5px] transition-colors duration-300 ${theme === 'nothing' ? '' : 'rounded-full'}`}
                                                style={{ 
                                                    backgroundColor: i === step ? currentTheme.stepActive : currentTheme.stepInactive,
                                                    borderRadius: theme === 'nothing' ? '0px' : undefined
                                                }}
                                            >
                                                <span 
                                                    className={`text-[14px] font-bold leading-[20px] text-center transition-colors duration-300 ${theme === 'nothing' ? 'font-mono' : ''}`}
                                                    style={{ 
                                                        color: i === step ? currentTheme.stepTextActive : currentTheme.stepTextInactive,
                                                        fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined
                                                    }}
                                                >
                                                    {i}
                                                </span>
                                            </div>
                                            {index < 3 && (
                                                <div className="flex-1 flex flex-col h-[2px] px-[12px] py-0 min-w-0">
                                                    <div className="bg-[#364153] h-[2px] w-full" />
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                                
                                {/* Step Title */}
                                        <div className="flex items-center justify-between h-[40px]">
                                    <div className="flex items-center gap-[8px]">
                                        {step === 2 && (
                                            <button 
                                                onClick={handlePrevStep}
                                                className={`w-[40px] h-[40px] flex items-center justify-center p-[8px] hover:opacity-80 transition-opacity ${theme === 'nothing' ? 'border border-black' : 'rounded-full'}`}
                                                style={{ color: currentTheme.textPrimary, borderRadius: theme === 'nothing' ? '0px' : undefined }}
                                            >
                                                <svg className="w-[24px] h-[24px]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                                </svg>
                                            </button>
                                        )}
                                        <span 
                                            className={`text-[19px] font-thin leading-[24px] transition-colors duration-300 ${theme === 'nothing' ? 'font-dot' : ''}`}
                                            style={{ 
                                                color: currentTheme.textPrimary,
                                                fontFamily: currentTheme.fontFamilyHeading || currentTheme.fontFamily // Apply theme font to step title
                                            }}
                                        >
                                            {step === 1 && 'SELECT PAIR'}
                                            {step === 2 && 'ENTER ADDRESS'}
                                            {step === 3 && 'SEND FUNDS'}
                                            {step === 4 && 'WAIT FOR THE EXCHANGE'}
                                        </span>
                                    </div>
                                    {step > 1 && step < 4 && (
                                        <button 
                                            onClick={handlePrevStep}
                                            className={`w-[40px] h-[40px] flex items-center justify-center pt-[8px] px-[8px] hover:opacity-80 transition-opacity ${theme === 'nothing' ? 'border border-black' : 'rounded-full'}`}
                                            style={{ color: currentTheme.textPrimary, borderRadius: theme === 'nothing' ? '0px' : undefined }}
                                        >
                                            <svg className="w-[24px] h-[24px]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                            </svg>
                                        </button>
                                    )}
                                </div>
                            </div>
                            
                            {/* Step 1: Select Pair */}
                            {step === 1 && (
                                <>
                                        <div className="flex items-center justify-between mb-3">
                                        <div className={`flex gap-0 p-1 ${theme === 'nothing' ? 'bg-transparent' : ''}`}>
                                            <button 
                                                onClick={() => handleModeSwitch('fixed')}
                                                className={`px-2 py-1 text-[12px] font-medium ${theme === 'nothing' ? 'font-mono uppercase border border-black' : 'rounded-full'} ${mode === 'fixed' ? (theme === 'nothing' ? 'bg-black text-white' : 'bg-[#f4f4f5] shadow-sm text-black') : (theme === 'nothing' ? 'bg-transparent text-black' : 'text-[#767676]')}`}
                                                style={{ borderRadius: theme === 'nothing' ? '0px' : undefined }}
                                            >
                                                {theme === 'nothing' ? 'FIXED RATE' : 'Fixed Rate'}
                                            </button>
                                            <button 
                                                onClick={() => handleModeSwitch('realtime')}
                                                className={`px-2 py-1 text-[12px] font-medium ${theme === 'nothing' ? 'font-mono uppercase border border-black ml-[-1px]' : 'rounded-full'} ${mode === 'realtime' ? (theme === 'nothing' ? 'bg-black text-white' : 'bg-[#f4f4f5] shadow-sm text-black') : (theme === 'nothing' ? 'bg-transparent text-black' : 'text-[#767676]')}`}
                                                style={{ borderRadius: theme === 'nothing' ? '0px' : undefined }}
                                            >
                                                {theme === 'nothing' ? 'REAL-TIME RATE' : 'Real-time Rate'}
                                            </button>
                                        </div>
                                        
                                        <div className={`text-[12px] font-medium ${theme === 'nothing' ? 'font-mono' : ''}`} style={{ color: currentTheme.textSecondary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                            {loading && <span className="text-[#767676]">{theme === 'nothing' ? 'LOADING...' : 'Loading...'}</span>}
                                            {!loading && rate && (
                                                <span>1 {fromAsset.symbol} ≈ {rate.toFixed(6)} {toAsset.symbol}</span>
                                            )}
                                            {mode === 'fixed' && fixedRateCountdown > 0 && (
                                                <span className="ml-2 text-[#7592f0] font-semibold">({fixedRateCountdown}s)</span>
                                            )}
                                        </div>
                                    </div>
                                    
                                    {/* From Input */}
                                    <div 
                                        className={`border transition-colors duration-300 ${theme === 'nothing' ? '' : 'rounded-[8px]'}`}
                                        style={{
                                            padding: currentTheme.inputPadding,
                                            marginBottom: currentTheme.inputGap,
                                            backgroundColor: currentTheme.inputBg,
                                            borderColor: currentTheme.borderColor,
                                            borderRadius: theme === 'nothing' ? '0px' : undefined
                                        }}
                                    >
                                        <div 
                                            className={`text-[12px] mb-2 font-medium ${theme === 'nothing' ? 'font-mono uppercase' : ''}`}
                                            style={{ color: currentTheme.textSecondary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}
                                        >{theme === 'nothing' ? 'YOU SEND' : 'You send'}</div>
                                        <div className="flex items-center gap-2">
                                            <div 
                                                className="flex items-center gap-2 cursor-pointer hover:opacity-80"
                                                onClick={() => setShowFromPicker(true)}
                                            >
                                                <img src={fromAsset.icon} alt={fromAsset.symbol} className="w-[36px] h-[36px] rounded-full" />
                                                <span 
                                                    className={`text-[20px] font-semibold ${theme === 'nothing' ? 'font-mono uppercase' : ''}`}
                                                    style={{ color: currentTheme.textPrimary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}
                                                >{fromAsset.symbol}</span>
                                            </div>
                                            <input
                                                type="number"
                                                value={fromAmount}
                                                onChange={(e) => handleFromAmountChange(e.target.value)}
                                                className={`flex-1 text-right text-[20px] font-semibold bg-transparent outline-none ${theme === 'nothing' ? 'font-mono' : ''}`}
                                                style={{ color: currentTheme.textPrimary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}
                                                placeholder="0"
                                            />
                                        </div>
                                        <div className={`text-[12px] mt-2 ${theme === 'nothing' ? 'font-mono uppercase' : ''}`} style={{ color: currentTheme.textSecondary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                            {fromAsset.network}
                                            {fromAsset.networkTag && (
                                                <span className={`ml-2 px-1 py-0.5 font-semibold ${theme === 'nothing' ? 'bg-black text-white border border-black' : 'bg-[#fae881] text-[#5c4d11] rounded-sm'}`} style={{ borderRadius: theme === 'nothing' ? '0px' : undefined }}>
                                                    {fromAsset.networkTag}
                                                </span>
                                            )}
                                        </div>
                                    </div>
                                    
                                    {/* Swap Button */}
                                    <div className="relative h-0">
                                        <button 
                                            onClick={handleSwap}
                                            className={`absolute left-1/2 transform -translate-x-1/2 -translate-y-5 p-2 hover:opacity-90 transition-colors duration-300 ${theme === 'nothing' ? 'border border-black' : 'rounded-full shadow-[0_2px_4px_0_rgba(0,0,0,0.1)]'}`}
                                            style={{ 
                                                backgroundColor: currentTheme.bgCard,
                                                border: theme === 'nothing' ? `1px solid ${currentTheme.borderColor}` : `${currentTheme.arrowBorder} solid ${currentTheme.bgCard}`,
                                                color: currentTheme.textPrimary,
                                                borderRadius: theme === 'nothing' ? '0px' : undefined
                                            }}
                                        >
                                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" />
                                            </svg>
                                        </button>
                                    </div>
                                    
                                    {/* To Input */}
                                    <div 
                                        className={`border mb-3 transition-colors duration-300 ${theme === 'nothing' ? '' : 'rounded-[8px]'}`}
                                        style={{
                                            padding: currentTheme.inputPadding,
                                            backgroundColor: currentTheme.inputBg,
                                            borderColor: currentTheme.borderColor,
                                            color: 'rgba(255, 0, 136, 1)',
                                            borderRadius: theme === 'nothing' ? '0px' : undefined
                                        }}
                                    >
                                        <div 
                                            className={`text-[12px] mb-2 font-medium ${theme === 'nothing' ? 'font-mono uppercase' : ''}`}
                                            style={{ color: currentTheme.textSecondary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}
                                        >{theme === 'nothing' ? 'YOU GET' : 'You get'}</div>
                                        <div className="flex items-center gap-2">
                                            <div 
                                                className="flex items-center gap-2 cursor-pointer hover:opacity-80"
                                                onClick={() => setShowToPicker(true)}
                                            >
                                                <img src={toAsset.icon} alt={toAsset.symbol} className="w-[36px] h-[36px] rounded-full" />
                                                <span 
                                                    className={`text-[20px] font-semibold ${theme === 'nothing' ? 'font-mono uppercase' : ''}`}
                                                    style={{ color: currentTheme.textPrimary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}
                                                >{toAsset.symbol}</span>
                                            </div>
                                            <input
                                                type="number"
                                                value={toAmount}
                                                onChange={(e) => handleToAmountChange(e.target.value)}
                                                className={`flex-1 text-right text-[20px] font-semibold bg-transparent outline-none ${theme === 'nothing' ? 'font-mono' : ''}`}
                                                style={{ color: currentTheme.textPrimary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}
                                                placeholder="0"
                                            />
                                        </div>
                                        <div className={`text-[12px] mt-2 ${theme === 'nothing' ? 'font-mono uppercase' : ''}`} style={{ color: currentTheme.textSecondary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                            {toAsset.network}
                                            {toAsset.networkTag && (
                                                <span className={`ml-2 px-1 py-0.5 font-semibold ${theme === 'nothing' ? 'bg-black text-white border border-black' : 'bg-[#c4d9fe] text-[#1f3c94] rounded-sm'}`} style={{ borderRadius: theme === 'nothing' ? '0px' : undefined }}>
                                                    {toAsset.networkTag}
                                                </span>
                                            )}
                                        </div>
                                    </div>
                                    
                                    {error && (
                                        <div className="text-red-500 text-[12px] mb-3">{error}</div>
                                    )}
                                </>
                            )}
                            
                            {/* Step 2: Enter Address */}
                            {step === 2 && (
                                <div className="py-4">
                                    <div className="mb-4">
                                        <label className={`block text-[14px] font-medium mb-2 ${theme === 'nothing' ? 'font-mono uppercase' : ''}`} style={{ color: currentTheme.textPrimary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                            {theme === 'nothing' ? `${toAsset.symbol} WALLET ADDRESS` : `${toAsset.symbol} Wallet Address`}
                                        </label>
                                        <input
                                            type="text"
                                            value={walletAddress}
                                            onChange={(e) => setWalletAddress(e.target.value)}
                                            placeholder={theme === 'nothing' ? `ENTER YOUR ${toAsset.symbol} ADDRESS` : `Enter your ${toAsset.symbol} address`}
                                            className={`w-full px-4 py-3 border outline-none ${theme === 'nothing' ? 'font-mono' : 'rounded-[8px]'} ${theme === 'nothing' ? 'focus:border-black' : 'focus:border-[#b1ff8c] focus:ring-2 focus:ring-[#b1ff8c]/20'}`}
                                            style={{ 
                                                backgroundColor: currentTheme.inputBg,
                                                borderColor: currentTheme.borderColor,
                                                color: currentTheme.textPrimary,
                                                borderRadius: theme === 'nothing' ? '0px' : undefined,
                                                fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined
                                            }}
                                        />
                                        <p className="text-[12px] mt-1" style={{ color: currentTheme.textSecondary }}>
                                            Make sure the address is correct. Transactions cannot be reversed.
                                        </p>
                                    </div>
                                    
                                    <div className={`border p-3 ${theme === 'nothing' ? 'bg-white border-black' : 'bg-[#fff8e1] border-[#fae881] rounded-[8px]'}`} style={{ borderRadius: theme === 'nothing' ? '0px' : undefined }}>
                                        <div className="flex gap-2">
                                            <span className="text-[16px]">⚠️</span>
                                            <div className={`text-[12px] ${theme === 'nothing' ? 'font-mono uppercase text-black' : 'text-[#5c4d11]'}`} style={{ fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                                {theme === 'nothing' ? 'DOUBLE-CHECK YOUR ADDRESS. SENDING TO THE WRONG ADDRESS MAY RESULT IN PERMANENT LOSS OF FUNDS.' : 'Double-check your address. Sending to the wrong address may result in permanent loss of funds.'}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {/* Step 3: Confirm */}
                            {step === 3 && (
                                <div className="py-4 space-y-4">
                                    <div 
                                        className={`border p-4 transition-colors duration-300 ${theme === 'nothing' ? '' : 'rounded-[8px]'}`}
                                        style={{
                                            backgroundColor: currentTheme.inputBg,
                                            borderColor: currentTheme.borderColor,
                                            borderRadius: theme === 'nothing' ? '0px' : undefined
                                        }}
                                    >
                                        <h3 className={`text-[16px] font-semibold mb-3 ${theme === 'nothing' ? 'font-mono uppercase' : ''}`} style={{ color: currentTheme.textPrimary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>{theme === 'nothing' ? 'TRANSACTION SUMMARY' : 'Transaction Summary'}</h3>
                                        
                                        <div className={`space-y-2 text-[14px] ${theme === 'nothing' ? 'font-mono' : ''}`} style={{ fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                            <div className="flex justify-between">
                                                <span style={{ color: currentTheme.textSecondary }}>{theme === 'nothing' ? 'YOU SEND' : 'You send'}</span>
                                                <span className="font-medium" style={{ color: currentTheme.textPrimary }}>{fromAmount} {fromAsset.symbol}</span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span style={{ color: currentTheme.textSecondary }}>{theme === 'nothing' ? 'YOU GET' : 'You get'}</span>
                                                <span className="font-medium" style={{ color: currentTheme.textPrimary }}>{toAmount} {toAsset.symbol}</span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span style={{ color: currentTheme.textSecondary }}>{theme === 'nothing' ? 'EXCHANGE RATE' : 'Exchange rate'}</span>
                                                <span className="font-medium" style={{ color: currentTheme.textPrimary }}>1 {fromAsset.symbol} = {rate?.toFixed(6)} {toAsset.symbol}</span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span style={{ color: currentTheme.textSecondary }}>{theme === 'nothing' ? 'PROVIDER' : 'Provider'}</span>
                                                <span className="font-medium" style={{ color: currentTheme.textPrimary }}>{selectedProvider}</span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span style={{ color: currentTheme.textSecondary }}>{theme === 'nothing' ? 'RECIPIENT ADDRESS' : 'Recipient address'}</span>
                                                <span className="font-medium text-[12px]" style={{ color: currentTheme.textPrimary }}>{walletAddress.substring(0, 10)}...{walletAddress.substring(walletAddress.length - 8)}</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div className={`text-[12px] ${theme === 'nothing' ? 'font-mono' : ''}`} style={{ color: currentTheme.textSecondary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                        By clicking "Confirm & Exchange", you agree to our Terms of Service and confirm that you have reviewed the transaction details.
                                    </div>
                                </div>
                            )}
                            
                            {/* Step 4: Processing */}
                            {step === 4 && (
                                <div className="py-8 text-center">
                                    <div className={`w-16 h-16 border-4 ${theme === 'nothing' ? 'border-black' : 'border-[#b1ff8c]'} border-t-transparent ${theme === 'nothing' ? '' : 'rounded-full'} spinner mx-auto mb-4`} style={{ borderRadius: theme === 'nothing' ? '0px' : undefined }}></div>
                                    <h3 className={`text-[20px] font-semibold mb-2 ${theme === 'nothing' ? 'font-dot uppercase' : ''}`} style={{ color: currentTheme.textPrimary, fontFamily: theme === 'nothing' ? currentTheme.fontFamilyHeading || currentTheme.fontFamily : undefined }}>{theme === 'nothing' ? 'PROCESSING EXCHANGE' : 'Processing Exchange'}</h3>
                                    <p className={`text-[14px] mb-4 ${theme === 'nothing' ? 'font-mono' : ''}`} style={{ color: currentTheme.textSecondary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                        Your exchange is being processed. This usually takes 5-40 minutes.
                                    </p>
                                    <div className={`${theme === 'nothing' ? 'bg-white border border-black' : 'bg-[#f0fff0] border border-[#b1ff8c]'} ${theme === 'nothing' ? '' : 'rounded-[8px]'} p-4 text-left`} style={{ borderRadius: theme === 'nothing' ? '0px' : undefined }}>
                                        <div className="flex items-start gap-2">
                                            <span className="text-[20px]">✓</span>
                                            <div>
                                                <div className={`font-medium text-[14px] ${theme === 'nothing' ? 'font-mono uppercase' : ''}`} style={{ color: theme === 'nothing' ? currentTheme.textPrimary : '#0a0a0a', fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>{theme === 'nothing' ? 'EXCHANGE INITIATED' : 'Exchange Initiated'}</div>
                                                <div className={`text-[12px] mt-1 ${theme === 'nothing' ? 'font-mono' : ''}`} style={{ color: theme === 'nothing' ? currentTheme.textSecondary : '#5a5a5a', fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                                    You will receive {toAmount} {toAsset.symbol} at {walletAddress.substring(0, 10)}...
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {/* Next Step Button */}
                            {step < 4 && (
                                <button
                                    onClick={handleNextStep}
                                    disabled={!canProceed || processing}
                                    style={{
                                        backgroundColor: currentTheme.primaryAction,
                                        borderRadius: currentTheme.radiusBtn,
                                        color: currentTheme.primaryText,
                                        fontFamily: currentTheme.fontFamily
                                    }}
                                    className={`w-full h-[48px] font-semibold text-[16px] transition-all hover:opacity-90 ${
                                        theme === 'nothing' ? 'font-mono uppercase' : ''
                                    } ${
                                        canProceed && !processing
                                            ? 'cursor-pointer opacity-100'
                                            : 'opacity-50 cursor-not-allowed'
                                    }`}
                                >
                                    {processing ? (theme === 'nothing' ? 'PROCESSING...' : 'Processing...') : step === 3 ? (theme === 'nothing' ? 'CONFIRM & EXCHANGE' : 'Confirm & Exchange') : (theme === 'nothing' ? 'NEXT STEP' : 'Next step')}
                                </button>
                            )}
                        </div>
                        
                        {/* Quotes Section (only on step 1) */}
                        {step === 1 && providers.length > 0 && (
                            <div 
                                className={`border mx-auto relative ${theme === 'nothing' ? '' : theme === 'uniswap' ? '' : 'shadow-[0_1px_3px_0_rgba(0,0,0,0.1),0_1px_2px_0_rgba(0,0,0,0.06)]'}`}
                                style={{
                                    padding: theme === 'uniswap' ? '12px' : '24px',
                                    borderColor: currentTheme.borderColor,
                                    borderRadius: currentTheme.radiusCard,
                                    width: currentTheme.cardWidth,
                                    maxWidth: '100%',
                                    zIndex: 1,
                                    boxShadow: theme === 'uniswap' ? '0px 4px 24px rgba(0, 0, 0, 0.04)' : undefined
                                }}
                            >
                                <h3 className={`text-[16px] font-semibold mb-3 ${theme === 'nothing' ? 'font-mono uppercase' : ''}`} style={{ color: currentTheme.textPrimary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>{theme === 'nothing' ? 'PROVIDER QUOTES' : 'Provider Quotes'}</h3>
                                
                                <div style={{ display: 'flex', flexDirection: 'column', gap: theme === 'uniswap' ? '4px' : '8px' }}>
                                    {providers.map(provider => {
                                        const isBest = provider.name === bestProvider;
                                        const isSelected = provider.name === selectedProvider;
                                        
                                        return (
                                            <div
                                                key={provider.name}
                                                onClick={() => {
                                                    setSelectedProvider(provider.name);
                                                    const newAmount = calculateQuote(rate, provider.name, fromAmount);
                                                    setToAmount(newAmount.toFixed(8));
                                                }}
                                                className={`provider-card flex items-center justify-between border ${
                                                    theme === 'nothing' ? '' : theme === 'uniswap' ? '' : 'rounded-[10px]'
                                                } ${
                                                    isSelected ? 'selected' : ''
                                                }`}
                                                style={{
                                                    padding: theme === 'uniswap' ? '16px' : '12px',
                                                    borderColor: isSelected ? (theme === 'nothing' ? currentTheme.borderColor : '#b1ff8c') : currentTheme.borderColor,
                                                    backgroundColor: isSelected ? currentTheme.bgCard : undefined,
                                                    borderRadius: theme === 'nothing' ? '0px' : theme === 'uniswap' ? '16px' : undefined
                                                }}
                                            >
                                                <div className="flex items-center gap-3">
                                                    <div className="w-[20px] h-[20px] rounded-sm overflow-hidden flex items-center justify-center">
                                                        {provider.name === 'NKX' && (
                                                            <div className="w-full h-full relative">
                                                                <img 
                                                                    src="https://www.figma.com/api/mcp/asset/1682a5b9-e4eb-4cf4-a784-9592eac95921"
                                                                    className="absolute inset-[8.33%] w-[83.34%] h-[83.34%]"
                                                                    alt=""
                                                                />
                                                                <p className="absolute inset-[27.08%_9.65%] m-0 font-sans text-[6px] font-bold text-[#163300] flex items-center justify-center">
                                                                    NKX
                                                                </p>
                                                            </div>
                                                        )}
                                                        {provider.name === 'ChangeNOW' && (
                                                            <div className="w-full h-full relative">
                                                                <img 
                                                                    src="https://www.figma.com/api/mcp/asset/179b0dbd-52e7-4b1a-8ecb-30df084634ed"
                                                                    className="absolute inset-[8.33%] w-[83.34%] h-[83.34%]"
                                                                    alt=""
                                                                />
                                                                <img 
                                                                    src="https://www.figma.com/api/mcp/asset/f220a5c2-d773-48b7-b68e-21ee20a16363"
                                                                    className="absolute inset-[8.33%] w-[83.34%] h-[83.34%] object-cover"
                                                                    alt=""
                                                                />
                                                            </div>
                                                        )}
                                                        {provider.name === 'Changelly' && (
                                                            <div className="w-full h-full relative">
                                                                <img 
                                                                    src="https://www.figma.com/api/mcp/asset/dfd187bd-2f5e-46bd-bd23-8568e6dc7912"
                                                                    className="absolute inset-[8.33%] w-[83.34%] h-[83.34%]"
                                                                    alt=""
                                                                />
                                                                <img 
                                                                    src="https://www.figma.com/api/mcp/asset/57f3654a-cbb0-44e8-8dc1-1a0d489f2692"
                                                                    className="absolute inset-[56.89%_54.17%_26.44%_22.92%] w-[22.92%] h-[16.67%]"
                                                                    alt=""
                                                                />
                                                                <img 
                                                                    src="https://www.figma.com/api/mcp/asset/91419e4c-2d5d-47ab-85bf-461f5a628391"
                                                                    className="absolute inset-[22.92%_22.48%_24.36%_24.66%] w-[52.42%] h-[52.72%]"
                                                                    alt=""
                                                                />
                                                            </div>
                                                        )}
                                                        {!['NKX', 'ChangeNOW', 'Changelly'].includes(provider.name) && (
                                                            <div className="w-full h-full bg-[#0a0a0a]"></div>
                                                        )}
                                                    </div>
                                                    <span 
                                                        className={`text-[14px] font-medium ${theme === 'nothing' ? 'font-mono uppercase' : ''}`}
                                                        style={{ color: currentTheme.textPrimary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}
                                                    >{provider.name}</span>
                                                    {isBest && (
                                                        <span className={`${theme === 'nothing' ? 'bg-black text-white border border-black font-mono uppercase' : 'bg-[#b1ff8c] text-[#0a0a0a]'} text-[10px] font-semibold px-2 py-0.5 ${theme === 'nothing' ? '' : 'rounded-full'}`} style={{ borderRadius: theme === 'nothing' ? '0px' : undefined }}>
                                                            BEST
                                                        </span>
                                                    )}
                                                </div>
                                                
                                                <div className="text-right">
                                                    {isBest && (
                                                        <div className={`text-[14px] font-semibold ${theme === 'nothing' ? 'font-mono text-black' : 'text-[#16c784]'}`} style={{ fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}>
                                                            +{(provider.amount - providers[providers.length - 1].amount).toFixed(6)} {toAsset.symbol}
                                                        </div>
                                                    )}
                                                    <div 
                                                        className={`text-[14px] font-medium ${theme === 'nothing' ? 'font-mono' : ''}`}
                                                        style={{ color: currentTheme.textPrimary, fontFamily: theme === 'nothing' ? currentTheme.fontFamily : undefined }}
                                                    >
                                                        {provider.amount.toFixed(6)} {toAsset.symbol}
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        )}
                    </div>
                    
                    {/* Asset Pickers */}
                    <AssetPickerModal
                        isOpen={showFromPicker}
                        onClose={() => setShowFromPicker(false)}
                        onSelect={setFromAsset}
                        excludeSymbol={toAsset.symbol}
                    />
                    
                    <AssetPickerModal
                        isOpen={showToPicker}
                        onClose={() => setShowToPicker(false)}
                        onSelect={setToAsset}
                        excludeSymbol={fromAsset.symbol}
                    />

                    {/* Step Controller Widget */}
                    <div className="fixed bottom-[24px] right-[24px] z-50">
                        <StepController 
                            currentStep={step}
                            onStepClick={setStep}
                            onPrev={handlePrevStep}
                            onNext={handleNextStep}
                            theme={theme}
                            setTheme={setTheme}
                            themeMode={themeMode}
                            setThemeMode={setThemeMode}
                            viewMode={viewMode}
                            setViewMode={setViewMode}
                        />
                    </div>
                </div>
            );
        }

        // Render
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ExchangeApp />);
    </script>
</body>
</html>
